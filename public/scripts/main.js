!function(t){function e(n){if(a[n])return a[n].exports;var o=a[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var a={};return e.m=t,e.c=a,e.p="",e(0)}([function(t,e,a){"use strict";var n=function(){function t(t,e){var a=[],n=!0,o=!1,l=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(a.push(r.value),!e||a.length!==e);n=!0);}catch(t){o=!0,l=t}finally{try{!n&&s.return&&s.return()}finally{if(o)throw l}}return a}return function(e,a){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();!function(){a(1);var t={body:$("body"),navBar:$(".nav.navbar-right"),modal:$("#modal"),modalTitle:$(".modal-title"),modalBody:$(".modal-body"),modalFooter:$(".modal-footer"),usingAs:$("#using-as"),contentContainer:$(".content-container"),defaultContainer:$(".default-container")},e={userName:null,users:[],usingAs:"",fireConfig:{apiKey:"AIzaSyA963YSjiL1EdZHtbczMMF314a1PkKUY7Q",authDomain:"dynamic-content-89943.firebaseapp.com",databaseURL:"https://dynamic-content-89943.firebaseio.com",storageBucket:"dynamic-content-89943.appspot.com",messagingSenderId:"983806324695"}},o={signinForm:a(2),navbarItems:a(3),switchNotice:a(4),switchBackNotice:a(5),noticeFooter:a(6)},l={init:function(){e.crudData=a(7),e.content=a(8),e.codeGeneration=a(14),e.tmpls=a(15),firebase.initializeApp(e.fireConfig),firebase.auth().onAuthStateChanged(function(a){a?(e.userName=a.email.split("@")[0],e.usingAs=e.userName,t.usingAs.val(e.userName),l.loadContent()):l.hideContent()})},showSignIn:function(){$("body").append($.charlie(o.signinForm,{})),$(".email").focus(),$(".signin-form").on("submit",l.signIn),$(".email, .password").on("keydown",l.checkField)},checkField:function(t){var e=$(t.target);""===e.val().trim()?e.parent().addClass("has-error"):e.parent().removeClass("has-error"),$(".signin-error-message").text("")},signIn:function(t){t.preventDefault();var e=$(".email"),a=$(".password"),n=!0;""===e.val().trim()?(e.parent().addClass("has-error"),n=!1):e.parent().removeClass("has-error"),""===a.val().trim()?(a.parent().addClass("has-error"),n=!1):e.parent().removeClass("has-error"),n&&firebase.auth().signInWithEmailAndPassword(e.val(),a.val()).catch(function(t){var e=t.code;t.message;e&&$(".signin-error-message").text("Ummmm...no..try again!")})},loadContent:function(){$("#signin-form-container").remove(),t.body.addClass("signed-in"),t.body.removeClass("signed-out"),e.users=[],firebase.database().ref("/").once("value",function(a){a=a.val(),Object.entries(a).forEach(function(t){var a=n(t,2),o=a[0];a[1];e.users.push({name:o})}),t.navBar.html($.charlie(o.navbarItems,e)),t.navBar.find(".users li").filter(function(){return $(this).text()==e.userName}).addClass("hidden"),t.navBar.find(".current-user").addClass("bg-success"),t.navBar.find(".switch-user").on("click",l.switchUser),t.navBar.find(".crud-data").on("click",e.crudData.funcs.showData),t.navBar.find(".sign-out").on("click",l.signOut),t.navBar.find(".get-code").on("click",e.codeGeneration.funcs.validateForm),t.navBar.find(".save-template").on("click",e.tmpls.funcs.startSave),t.navBar.find(".manage-tmpls").on("click",e.tmpls.funcs.manageTemplates),t.navBar.find(".type").on("click",e.content.switchType),e.content.init(),e.tmpls.funcs.getTemplates()}),l.populateFooter()},signOut:function(t){t.preventDefault(),firebase.auth().signOut().then(function(){},function(t){})},hideContent:function(){e.content.resetvars(),t.body.removeClass("signed-in"),t.body.addClass("signed-out"),t.contentContainer.empty(),t.defaultContainer.empty(),t.navBar.empty(),l.showSignIn(),$("#quote-container").empty()},switchUser:function(a){a.preventDefault();var n=$(a.target).text(),l=e.userName==n?o.switchBackNotice:o.switchNotice;t.usingAs.val(n),e.usingAs=n,e.content.init(),t.navBar.find(".current-user").html(n+' <span class="caret"></span>'),t.navBar.find(".users .hidden").removeClass("hidden"),t.navBar.find(".users li").filter(function(){return $(this).text()==n}).addClass("hidden"),e.usingAs!==e.userName?(t.navBar.find(".save-template").addClass("hidden"),t.navBar.find(".current-user").addClass("bg-warning").removeClass("bg-success")):(t.navBar.find(".save-template").removeClass("hidden"),t.contentContainer.find(".save-rule-group").removeClass("hidden"),t.navBar.find(".current-user").addClass("bg-success").removeClass("bg-warning")),e.tmpls.funcs.getTemplates(),t.modalTitle.html("Switching Users"),t.modalBody.html($.charlie(l,e)),t.modalFooter.html(o.noticeFooter),t.modal.modal("show"),t.modal.on("shown.bs.modal",function(){t.modalFooter.find(".btn").focus()})},populateFooter:function(){$.getJSON("https://quotesondesign.com/wp-json/posts?filter[orderby]=rand&filter[posts_per_page]=5&callback=",function(t){var e=document.createElement("p"),a=document.createElement("p");e.appendChild(document.createTextNode($(t[0].content).text())),a.appendChild(document.createTextNode(" - "+t[0].title)),$("#quote-container").empty().prepend("<hr>").append(e).append(a)})}};l.init()}()},function(t,e){"use strict";/*! Charlie Template Plugin 2016, Ehren Coker */
!function(t){t.extend({charlie:function(e,a){var n=function(){return"{{ ERROR: "+arguments[1]+"}}"},o=/{{([^#\/][^}]+)}}/g,l=/{{#([^\s]+)}}([\s\S\n]*){{\/\1}}/g,r=/{{#each\s+([^\s]+)\s+in\s+([^\s|}]+)}}([\s\S\n]*?({{#each[^}]+}}[\s\S\n]*?{{\/each}})?[\s\S\n]*?){{\/each}}/i,s=function(t){t=t.split(".");for(var e=a,n=0;n<t.length;n++){if("undefined"==typeof e[t[n]])return!1;e=e[t[n]]}return e},i=function(){var t=arguments[1],e=s(t);return"string"!=typeof e&&"number"!=typeof e?n(arguments):e},d=function(){var t=arguments[1];return s(t)?/{{else}}/.test(arguments[2])?arguments[2].replace(/{{else}}.*/,""):arguments[2]:/{{else}}/.test(arguments[2])?arguments[2].replace(/.*{{else}}/,""):""},c=function(){var e=arguments[1],n=arguments[2],r=arguments[3];if(a[n])var s=t.map(a[n],function(t){a[e]=t;for(var n=r;l.test(n);)n=n.replace(l,d);return n.replace(o,i)}).join("");return s},u=function(e,a){var n=t.map(a,function(a){return t.charlie(e,a)});return n.join("")};if("[object Array]"!==Object.prototype.toString.call(a)){for("string"!=typeof e&&(e=e.join(""));r.test(e);)e=e.replace(r,c);l.test(e)&&(e=e.replace(l,d));var p=e.replace(o,i);return p}u(e,a)}})}(jQuery)},function(t,e){"use strict";t.exports='\n\t<div id="signin-form-container">\n\t\t<form name="signin-form" class="signin-form" action="" method="post">\n\t\t\t<h3>Welcome back</h3>\n\t\t\t<div class="form-group">\n\t\t\t\t<label class="sr-only">User Name:</label>\n\t\t\t\t<input type="text" class="form-control email" name="email" placeholder="myname@caleres.com">\n\t\t\t</div>\n\t\t\t<div class="form-group">\n\t\t\t\t<label class="sr-only">Password:</label>\n\t\t\t\t<input type="password" class="form-control password" name="password" placeholder="Password">\n\t\t\t</div>\n\t\t\t<span class="signin-error-message"></span>\n\t\t\t<button type="submit" class="btn btn-primary sign-in form-control">Continue</button>\t\n\t\t</form>\n\t</div>\n'},function(t,e){"use strict";t.exports='\n\t<li>\n\t\t<button type="button" class="btn btn-success get-code">Get Code</button>\n\t</li>\n\t<li class="dropdown content-type">\n\t\t<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Type <span class="caret"></span></a>\n\t\t<ul class="dropdown-menu">\n\t\t\t<li><a href="#" class="type" data-type="subject">Subject</a></li>\n\t\t\t<li><a href="#" class="type" data-type="preheader">Preheader</a></li>\n\t\t\t<li><a href="#" class="type" data-type="content">Content</a></li>\n\t\t\t<li><a href="#" class="type" data-type="subject-preheader">Subject and Preheader</a></li>\n\t\t\t<li><a href="#" class="type" data-type="subject-preheader-content"><span class="glyphicon glyphicon-ok"></span> All</a></li>\n\t\t</ul>\n\t</li>\n\t<li class="dropdown">\n\t\t<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Templates <span class="caret"></span></a>\n\t\t<ul class="dropdown-menu">\n\t\t\t<li><a href="#" class="manage-tmpls">Manage Templates</a></li>\n\t\t\t<li><a href="#" class="save-template">Save Template</a></li>\n\t\t</ul>\n\t</li>\n\t<li class="dropdown">\n\t\t<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Dropdowns <span class="caret"></span></a>\n\t\t<ul class="dropdown-menu">\n\t\t\t<li><a href="#" class="crud-data" data-type="attribute">Attributes</a></li>\n\t\t\t<li><a href="#" class="crud-data" data-type="value">Values</a></li>\n\t\t</ul>\n\t<li class="dropdown">\n\t\t<a href="#" class="dropdown-toggle current-user" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">{{userName}} <span class="caret"></span></a>\n\t\t<ul class="dropdown-menu users">\n\t\t\t<li class="dropdown-header">Use As:</li>\n\t\t\t{{#each user in users}}\n\t\t\t\t<li><a href="#" class="switch-user">{{user.name}}</a></li>\n\t\t\t{{/each}}\n\t\t\t<li role="separator" class="divider"></li>\n\t\t\t<li><a href="#" class="sign-out">Sign Out</a></li>\n\t\t</ul>\n\t</li>\n'},function(t,e){"use strict";t.exports="\t\nYou're switching to <strong>{{usingAs}}</strong>!  What does this mean?  You'll be able to see {{usingAs}}'s\nattributes, values, tmpls, and rule groups.  You'll also be able to use the form with {{usingAs}}'s \ninformation, and export code as usual.  However, you won't be able to change any saved data, or save any new \ndata (rule groups, tmpls, favorites, defaults).  You'll have to switch back to {{userName}} to do that!\n"},function(t,e){"use strict";t.exports="\nWelcome back, <strong>{{userName}}</strong>!  You should have full access now.  Enjoy!\n"},function(t,e){"use strict";t.exports='\n\t<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n'},function(t,e){"use strict";var a={modal:$("#modal"),modalTitle:$(".modal-title"),modalBody:$(".modal-body"),modalFooter:$(".modal-footer"),usingAs:$("#using-as")},n={tableSize:10,pageNum:1,dataValue:"",dataType:"",userName:null},o={resetvars:function(){n.dataValue="",n.dataType=""},showData:function(t){t.preventDefault(),o.resetvars();var e=$(t.target);n.userName=firebase.auth().currentUser.email.split("@")[0];var r=a.usingAs.val();e.hasClass("crud-data")&&(n.pageNum=1),n.dataType=e.data("type"),a.modalTitle.text(""+n.dataType),a.modalBody.html(l.spinner),a.modalFooter.html(l.showFooter),firebase.database().ref(r+"/"+n.dataType+"s/").once("value").then(function(t){var e=t.val();a.modalBody.html(l.dataTable(e)),a.modalBody.append(l.dataPager(e)),$(".pagination li:nth-of-type("+n.pageNum+")").addClass("active"),a.modalBody.find(".table-responsive:nth-of-type("+n.pageNum+")").length?a.modalBody.find(".table-responsive:nth-of-type("+n.pageNum+")").removeClass("hidden"):(n.pageNum>1&&n.pageNum--,a.modalBody.find(".table-responsive:nth-of-type("+n.pageNum+")").removeClass("hidden")),$(".pagination a").on("click",o.updateDataPage),$(".delete-data").on("click",o.confirmDeleteData),$(".edit-data").on("click",o.dataForm),$(".is-default").on("click",o.saveIsDefault)}),$(".new-"+n.dataType).on("click",o.dataForm),a.modal.modal("show")},updateDataPage:function(t){t.preventDefault();var e=$(t.target);n.pageNum=e.data("pager"),$(".pagination .active").removeClass("active"),e.parent().addClass("active"),a.modalBody.find(".table-responsive").addClass("hidden"),a.modalBody.find(".table-responsive:nth-child("+n.pageNum+")").removeClass("hidden")},dataForm:function(t){a.modalBody.html(l.dataForm(t)),a.modalFooter.html(l.saveFooter),$("#"+n.dataType+"-name").on("keyup",o.processKey),$(".back-"+n.dataType).on("click",o.showData),$(".save-"+n.dataType).on("click",o.saveData),$("#"+n.dataType+"-name").focus()},saveData:function(t){var e=a.modalFooter.find(".btn-primary"),l=$("#"+n.dataType+"-name"),r=$("#"+n.dataType+"-default"),s=firebase.auth().currentUser.email.split("@")[0],i=l.val().trim(),d=r.is(":checked");return i&&/^[0-9a-zA-Z\ \-\_]+$/.test(i)?(n.dataValue&&n.dataValue!=i&&firebase.database().ref(s+"/"+n.dataType+"s/"+n.dataValue).remove(),d?o.saveIsDefault(t,i):firebase.database().ref(s+"/"+n.dataType+"s/"+i).set({isDefault:d}),e.remove(),a.modalFooter.find("button").focus(),a.modalBody.html("The "+n.dataType+" has been successfully saved!"),void(n.dataValue="")):void l.parent().addClass("has-error")},saveIsDefault:function(t,e){e=e||$(t.target).data("value");var a={},o=o=firebase.auth().currentUser.email.split("@")[0];firebase.database().ref(o+"/"+n.dataType+"s/").once("value").then(function(t){var l=t.val();for(var r in l)a[o+"/"+n.dataType+"s/"+r+"/isDefault"]=!1;firebase.database().ref().update(a).then(function(){firebase.database().ref(o+"/"+n.dataType+"s/"+e).set({isDefault:!0})})})},confirmDeleteData:function(t){n.dataValue=$(t.target).data("value"),a.modalBody.html("Are you sure you want to delete <strong>"+n.dataValue+"</strong> from "+n.dataType+"s?"),a.modalFooter.html(l.confirmFooter),a.modalFooter.find(".confirm-delete").on("click",o.deleteData),a.modalFooter.find(".back-"+n.dataType).on("click",o.showData),a.modalFooter.find(".confirm-delete").focus()},deleteData:function(){var t=t=firebase.auth().currentUser.email.split("@")[0];firebase.database().ref(t+"/"+n.dataType+"s/"+n.dataValue).remove(),a.modalBody.html("<strong>"+n.dataValue+"</strong> has been deleted from "+n.dataType+"s!"),a.modalFooter.find(".confirm-delete").remove(),a.modalFooter.find("button").focus(),n.dataValue=""},processKey:function(t){$(t.target).parent().removeClass("has-error"),13==t.which&&a.modalFooter.find(".btn-primary").trigger("click")}},l={dataForm:function(t){var e=$(t.target),a="";return e.hasClass("edit-data")&&(n.dataValue=e.data("value"),e.parent().parent().find(".is-default").is(":checked")&&(a=" checked")),'\n\t\t\t<div class="form-group">\n\t\t\t\t<label for="'+n.dataType+'-name">'+n.dataType+' Name:</label>\n\t\t\t\t<input type="text" id="'+n.dataType+'-name" class="form-control" value="'+n.dataValue+'">\n\t\t\t</div>\n\t\t\t<div class="form-group">\n\t\t\t\t<label>\n\t\t\t\t\t<input type="checkbox" id="'+n.dataType+'-default"'+a+"> Default\n\t\t\t\t</label>\n\t\t\t</div>"},showFooter:function(){var t=n.userName==a.usingAs.val()?'<button type="button" class="btn btn-primary new-'+n.dataType+'">New '+n.dataType+"</button>":"";return'\n\t\t\t<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n\t\t\t'+t},saveFooter:function(){return'\n\t\t\t<button type="button" class="btn btn-default back-'+n.dataType+'" data-type="'+n.dataType+'">Back</button>\n\t\t\t<button type="button" class="btn btn-primary save-'+n.dataType+'">Save '+n.dataType+"</button>"},confirmFooter:function(){return'\n\t\t\t<button type="button" class="btn btn-default back-'+n.dataType+'" data-type="'+n.dataType+'">Back</button>\n\t\t\t<button type="button" class="btn btn-danger confirm-delete">Delete '+n.dataType+"</button>"},dataTable:function(t){if(!t)return"Looks like you don't have any "+n.dataType+"!  Click the blue button below to get started!";var e="",o="",l=0,r=Object.keys(t).length,s="",i=n.userName==a.usingAs.val()?"\n\t\t\t\t\t\t\t<th>Default</th>\n\t\t\t\t\t\t\t<th>Edit</th>\n\t\t\t\t\t\t\t<th>Delete</th>":"",d='\n\t\t    \t<div class="table-responsive hidden">\n\t\t\t\t\t<table class="table table-condensed table-striped data-table">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<th>'+n.dataType+"</th>\n\t\t\t\t\t\t\t"+i+"\n\t\t\t\t\t\t</tr>",c="\n\t\t\t\t\t</table>\n\t\t\t\t</div>";e=d;for(var u in t)l++,o=t[u].isDefault?" checked":"",s=n.userName==a.usingAs.val()?'\n\t\t\t\t\t<td><input type="radio" class="is-default" name="is-default"'+o+' data-value="'+u+'"></td>\n\t\t\t\t\t<td><span class="glyphicon glyphicon-pencil edit-data" data-value="'+u+'"></span></td>\n\t\t\t\t\t<td><span class="glyphicon glyphicon-trash delete-data" data-value="'+u+'"></span></td>\n\t\t\t':"",e+="\n\t\t\t\t<tr>\n\t\t\t\t\t<td>"+u+"</td>\n\t\t\t\t\t"+s+"\n\t\t\t\t</tr>",l%n.tableSize!=0&&l!=r||(e+=c,l<r&&(e+=d));return e},dataPager:function(t){if(t){var e=Object.keys(t).length,a=0,o=0,l='<nav aria-label="Page navigation">\n\t\t\t\t\t\t\t<ul class="pagination">';if(!(e<=n.tableSize)){for(o=e/n.tableSize,e%(o*n.tableSize)!=0&&o++,a=0;a<o;a++)l+='\n\t\t\t\t<li>\n\t\t\t\t\t<a href="#" data-pager="'+(a+1)+'">'+(a+1)+"</a>\n\t\t\t\t</li>\n\t\t\t";return l+"</ul></nav>"}}},spinner:function(){return"<span class='glyphicon glyphicon-asterisk'></span>"}};t.exports={funcs:o,tmpls:l}},function(t,e,a){"use strict";var n={modal:$("#modal"),modalTitle:$(".modal-title"),modalBody:$(".modal-body"),modalFooter:$(".modal-footer"),contentContainer:$(".content-container"),defaultContainer:$(".default-container"),navBar:$(".nav.navbar-right"),contentType:$("#content-type")},o={contentId:1,firstBlock:!0,extensionsReceived:!1,attributesReceived:!1,valuesReceived:!1,attributes:[],values:[],deleteRuleRow:null,deleteRulePanel:null,animating:!1,dataType:null,userName:null},l={contentBlock:a(9),addRuleRow:a(10),defaultContent:a(11),confirmDeleteRuleFooter:a(12)},r={init:function(){r.resetvars(),o.ruleGroups=a(13),o.userName=firebase.auth().currentUser.email.split("@")[0],r.getAttributes(),r.getValues(),o.ruleGroups.getRules()},resetvars:function(){o.contentId=1,o.firstBlock=!0,o.attributesReceived=!1,o.valuesReceived=!1,o.attributes=[],o.values=[]},getAttributes:function(){var t=$("#using-as").val();firebase.database().ref(t+"/attributes/").on("value",function(t){o.attributes=[];var e=t.val();for(var a in e)o.attributes.push({name:a,isDefault:e[a].isDefault});o.attributesReceived=!0,o.firstBlock?r.addContentBlock():(o.dataType="attribute",r.updateSelects())})},getValues:function(){var t=$("#using-as").val();firebase.database().ref(t+"/values/").on("value",function(t){o.values=[];var e=t.val();for(var a in e)o.values.push({name:a,isDefault:e[a].isDefault});o.valuesReceived=!0,o.firstBlock?r.addContentBlock():(o.dataType="value",r.updateSelects())})},addContentBlock:function(t){if(o.attributesReceived&&o.valuesReceived){var e=$($.charlie(l.contentBlock,o)),a=n.contentType.val();if("subject"==a?e.find(".preheader, .content-block").closest(".row").hide():"preheader"==a?e.find(".subject-line, .content-block").closest(".row").hide():"subject-preheader"==a?e.find(".content-block").closest(".row").hide():"content"==a&&e.find(".preheader, .subject-line").closest(".row").hide(),o.firstBlock)n.contentContainer.html(e),o.firstBlock=!1,r.addDefaultContent();else if(t){var s=$(t.target);s.blur().closest(".panel").after(e)}else n.contentContainer.append(e);var i=$("#panel-"+o.contentId);i.find(".add-rule").on("click",r.addRule),i.find(".delete-rule").on("click",r.confirmDeleteRule),i.find(".add-content-block").on("click",r.addContentBlock),i.find(".delete-content-block").on("click",r.deleteContentBlock),i.find(".move-content-up").on("click",r.moveContentUp),i.find(".move-content-down").on("click",r.moveContentDown),i.find(".manage-rule-group").on("click",o.ruleGroups.manageRules),i.find(".save-rule-group").on("click",o.ruleGroups.startSave),i.find(".content-block").on("keydown",r.clearContentError),i.find(".attribute-select, .value-select").on("change",r.clearContentError);var d=firebase.auth().currentUser.email.split("@")[0],c=$("#using-as").val();d!==c?n.contentContainer.find(".save-rule-group").addClass("hidden"):n.contentContainer.find(".save-rule-group").removeClass("hidden"),r.enableButtons(),o.contentId++}},addDefaultContent:function(){n.defaultContainer.html($.charlie(l.defaultContent,{})),n.defaultContainer.find("#content-default").on("keyup",r.clearContentError)},enableButtons:function(){var t=$(".delete-content-block"),e=$(".move-content-up"),a=$(".move-content-down"),n=$(".content-panel");t.length>1&&t.prop("disabled",!1),1==n.length?(e.prop("disabled",!0),a.prop("disabled",!0)):(n.find(".move-content-up, .move-content-down").prop("disabled",!1),n.first().find(".move-content-up").prop("disabled",!0),n.last().find(".move-content-down").prop("disabled",!0))},moveContentUp:function(t){if(!o.animating){o.animating=!0;var e=$(".content-container"),a=$(t.target),n=a.closest(".panel"),l=n.index(void 0),s=e.find(".panel").eq(l-1);$.when(n.animate({top:-s.outerHeight()-28},600),s.animate({top:n.outerHeight()+28},600)).done(function(){s.css("top","0px"),n.css("top","0px"),s.before(n),o.animating=!1,r.enableButtons()})}},moveContentDown:function(t){if(!o.animating){o.animating=!0;var e=$(".content-container"),a=$(t.target),n=a.closest(".panel"),l=n.index(void 0),s=e.find(".panel").eq(l+1);$.when(n.animate({top:+s.outerHeight()+28},600),s.animate({top:-n.outerHeight()-28},600)).done(function(){s.css("top","0px"),n.css("top","0px"),s.after(n),o.animating=!1,r.enableButtons()})}},updateSelects:function(){var t="",e="",a="",n=null;o[o.dataType+"s"].forEach(function(a){t+=s.selectOptions(a),a.isDefualt&&(e=a.name)});var l=$("."+o.dataType+"-select");l.each(function(o,l){n=$(l),a=n.val(),n.html(t),n.find('option[value="'+a+'"]').length>0?n.val(a):e?n.val(e):n[0].selectedIndex=0,n.trigger("change")}),o.dataType=null},addRule:function(t){if(t){var e=$(t.target),a=e.data("panel-id"),n=$("#panel-"+a);e.blur()}else var n=$(".content-panel").last();n.find(".add-rule-row").before($.charlie(l.addRuleRow,o)),n.find(".delete-rule").last().on("click",r.confirmDeleteRule),n.find(".delete-rule").length>0&&n.find(".delete-rule").prop("disabled",!1)},confirmDeleteRule:function(t){var e=$(t.target);o.deleteRuleRow=e.closest(".row").index(void 0)+1,o.deleteRulePanel=e.closest(".panel").attr("id"),n.modalTitle.html("Confirm Rule Delete"),n.modalBody.html("Are you sure you want to delete the rule?"),n.modalFooter.html($.charlie(l.confirmDeleteRuleFooter,o)),n.modal.modal("show"),n.modalFooter.find(".confirm-delete-rule").on("click",r.deleteRule)},deleteRule:function(){var t=$("#"+o.deleteRulePanel);t.find(".row").eq(o.deleteRuleRow).remove();var e=t.find(".delete-rule");1==e.length&&e.prop("disabled",!0),n.modalTitle.html("Rule Deleted"),n.modalBody.html("The rule has been deleted!"),n.modalFooter.find(".confirm-delete-rule").remove(),n.modalFooter.find("button").text("Close").focus(),o.deleteRulePanel=null,o.deleteRuleRow=null},deleteContentBlock:function(t){$(t.target).closest(".panel").remove();var e=$(".delete-content-block");1==e.length&&e.prop("disabled",!0),r.enableButtons()},switchType:function(t){t.preventDefault();var e=$(t.target).data("type");n.contentType.val(e),n.navBar.find(".glyphicon-ok").remove(),n.navBar.find('[data-type="'+e+'"]').prepend(s.checkmark()),"subject"===e?($(".preheader-group, .content-group").closest(".row").slideUp(),$(".subject-group").closest(".row").slideDown()):"preheader"===e?($(".subject-group, .content-group").closest(".row").slideUp(),$(".preheader-group").closest(".row").slideDown()):"content"===e?($(".subject-group, .preheader-group").closest(".row").slideUp(),$(".content-group").closest(".row").slideDown()):"subject-preheader"===e?($(".content-group").closest(".row").slideUp(),$(".subject-group, .preheader-group").closest(".row").slideDown()):$(".content-group, .subject-group, .preheader-group").closest(".row").slideDown()},clearContentError:function(t){$(t.target).parent().removeClass("has-error")}},s={selectOptions:function(t){return'<option value="'+t.name+'">'+t.name+"</option>"},checkmark:function(){return'<span class="glyphicon glyphicon-ok"></span> '}};t.exports=r},function(t,e){"use strict";t.exports='\n<div class="panel panel-default content-panel" id="panel-{{contentId}}">\n\t<div class="panel-heading">\n\t\t<div class="row">\n\t\t\t<div class="col-xs-6">\n\t\t\t\t<h3 class="panel-title">Content Block</h3>\n\t\t\t</div>\n\t\t\t<div class="col-xs-6">\n\t\t\t\t<div class="form-group rule-group form-inline">\n\t\t\t\t\t<label for="rules-operator-{{contentId}}">Rule Operator: </label>\n\t\t\t\t\t<select class="form-control rule-operator" id="rules-operator-{{contentId}}">\n\t\t\t\t\t\t<option value="or">or</option>\n\t\t\t\t\t\t<option value="and">and</option>\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="panel-body">\n\t    <div class="row">\n\t\t\t<div class="col-xs-12">\n\t\t\t\t<div class="form-group subject-group">\n\t\t\t\t\t<label for="subject-line-{{contentId}}">Subject Line: </label>\n\t\t\t\t\t<input type="text" class="form-control subject-line" id="subject-line-{{contentId}}">\n\t\t\t\t</div>\t\t\t\t\n\t\t\t</div>\n\t    </div>\n\t\t<div class="row">\n\t\t\t<div class="col-xs-12">\n\t\t\t\t<div class="form-group preheader-group">\n\t\t\t\t\t<label for="preheader-line-{{contentId}}">Preheader: </label>\n\t\t\t\t\t<input type="text" class="form-control preheader" id="preheader-{{contentId}}">\n\t\t\t\t</div>\t\t\t\t\n\t\t\t</div>\n\t    </div>\n\t\t<div class="row">\n\t\t\t<div class="col-xs-12">\n\t\t\t\t<div class="form-group content-group">\n\t\t\t\t\t<label for="content-{{contentId}}">Content: </label>\n\t\t\t\t\t<textarea class="form-control content-block" id="content-{{contentId}}"></textarea>\n\t\t\t\t</div>\t\t\t\t\n\t\t\t</div>\n\t    </div>\n\t\t<div class="row hidden-xs">\n\t\t\t<div class="col-sm-4">\n\t\t\t\t<h5>Attributes</h5>\n\t\t\t</div>\n\t\t\t<div class="col-sm-4 col-sm-offset-3">\n\t\t\t\t<h5>Values</h5>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="row rule-row">\n\t\t\t<div class="col-sm-4">\n\t\t\t\t<div class="form-group">\n\t\t\t\t\t<select class="form-control attribute-select">\n\t\t\t\t\t\t{{#each attribute in attributes}}\n\t\t\t\t\t\t\t<option value="{{attribute.name}}"{{#attribute.isDefault}}selected="selected"{{/attribute.isDefault}}>{{attribute.name}}</option>\n\t\t\t\t\t\t{{/each}}\t\t\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="col-sm-3">\n\t\t\t\t<div class="form-group">\n\t\t\t\t\t<select class="form-control comparison-type-select">\n\t\t\t\t\t\t<option value="equals">is equal to</option>\n\t\t\t\t\t\t<option value="not-equals">is not equal to</option>\n\t\t\t\t\t\t<option value="greater-than">is >= than</option>\n\t\t\t\t\t\t<option value="less-than">is <= than</option>\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="col-sm-4">\n\t\t\t\t<div class="form-group">\n\t\t\t\t\t<select class="form-control value-select">\n\t\t\t\t\t\t{{#each value in values}}\n\t\t\t\t\t\t\t<option value="{{value.name}}"{{#value.isDefault}}selected="selected"{{/value.isDefault}}>{{value.name}}</option>\n\t\t\t\t\t\t{{/each}}\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="col-sm-1 trash-container">\n\t\t\t\t<button type="button" class="glyphicon glyphicon-trash btn btn-default delete-rule form-control" title="Delete rule" disabled></button>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="row add-rule-row">\n\t\t\t<div class="col-xs-12">\n\t\t\t\t<button type="button" class="btn btn-primary form-control add-rule" data-panel-id="{{contentId}}"> Add Rule</button>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="panel-controls panel-footer">\n\t\t<button class="btn move-content-up" title="Move content block up" disabled><span class="glyphicon glyphicon-arrow-up"></button>\n\t\t<button class="btn move-content-down" title="Move content block down" disabled><span class="glyphicon glyphicon-arrow-down"></button>\n\t\t<div class="dropdown">\n\t\t\t<button class="dropdown-toggle" type="button" id="panel-menu-{{contentId}}" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" title="More content block options">\n\t\t\t\t<span class="glyphicon glyphicon-option-horizontal"></span>\n\t\t\t</button>\n\t\t\t<ul class="dropdown-menu" aria-labelledby="panel-menu-{{contentId}}">\n\t\t\t\t<li><a href="#" class="manage-rule-group">Manage Rule Groups</a></li>\n\t\t\t\t<li><a href="#" class="save-rule-group">Save Rule Group</a></li>\n\t\t\t</ul>\n\t\t</div>\n\t\t<button class="btn add-content-block" title="Add new content block"><span class="glyphicon glyphicon-plus"></span></button>\n\t\t<button class="btn delete-content-block" title="Delete content block" disabled><span class="glyphicon glyphicon-trash"></span></button>\n\t</div>\n</div>'},function(t,e){"use strict";t.exports='\n\t<div class="row rule-row">\n\t\t<div class="col-sm-4">\n\t\t\t<div class="form-group">\n\t\t\t\t<select class="form-control attribute-select">\n\t\t\t\t\t{{#each attribute in attributes}}\n\t\t\t\t\t\t<option value="{{attribute.name}}"{{#attribute.isDefault}}selected="selected"{{/attribute.isDefault}}>{{attribute.name}}</option>\n\t\t\t\t\t{{/each}}\t\t\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="col-sm-3">\n\t\t\t<div class="form-group">\n\t\t\t\t<select class="form-control comparison-type-select">\n\t\t\t\t\t<option value="equals">is equal to</option>\n\t\t\t\t\t<option value="not-equals">is not equal to</option>\n\t\t\t\t\t<option value="greater-than">is >= than</option>\n\t\t\t\t\t<option value="less-than">is <= than</option>\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="col-sm-4">\n\t\t\t<div class="form-group">\n\t\t\t\t<select class="form-control value-select">\n\t\t\t\t\t{{#each value in values}}\n\t\t\t\t\t\t<option value="{{value.name}}"{{#value.isDefault}}selected="selected"{{/value.isDefault}}>{{value.name}}</option>\n\t\t\t\t\t{{/each}}\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="col-sm-1 trash-container">\n\t\t\t<button type="button" class="glyphicon glyphicon-trash btn btn-default delete-rule form-control" title="Delete rule"></button>\n\t\t</div>\n\t</div>'},function(t,e){"use strict";t.exports='\n<div class="panel panel-default" id="panel-{{contentId}}">\n\t<div class="panel-heading">\n\t\t<div class="row">\n\t\t\t<div class="col-xs-12">\n\t\t\t\t<h3 class="panel-title">Default Content</h3>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="panel-body">\n\t    <div class="row">\n\t\t\t<div class="col-xs-12">\n\t\t\t\t<div class="form-group subject-group">\n\t\t\t\t\t<label for="subject-line-default">Subject Line: </label>\n\t\t\t\t\t<input type="text" class="form-control subject-line" id="subject-line-default">\n\t\t\t\t</div>\t\t\t\t\n\t\t\t</div>\n\t    </div>\n\t\t<div class="row">\n\t\t\t<div class="col-xs-12">\n\t\t\t\t<div class="form-group preheader-group">\n\t\t\t\t\t<label for="preheader-default">Preheader: </label>\n\t\t\t\t\t<input type="text" class="form-control preheader" id="preheader-default">\n\t\t\t\t</div>\t\t\t\t\n\t\t\t</div>\n\t    </div>\n\t\t<div class="row">\n\t\t\t<div class="col-xs-12">\n\t\t\t\t<div class="form-group content-group">\n\t\t\t\t\t<label for="content-default">Content: </label>\n\t\t\t\t\t<textarea class="form-control content-block" id="content-default"></textarea>\n\t\t\t\t</div>\t\t\t\t\n\t\t\t</div>\n\t    </div>\n\t</div>\n</div>'},function(t,e){"use strict";t.exports='\n\t<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>\n\t<button type="button" class="btn btn-danger confirm-delete-rule" data-row="{{deleteRuleRow}}">Delete Rule</button>\n'},function(t,e,a){"use strict";var n={modal:$("#modal"),modalTitle:$(".modal-title"),modalBody:$(".modal-body"),modalFooter:$(".modal-footer")},o={saveNameVal:"",$panel:null,rules:null,canSave:!1,tableSize:10,ruleName:null,panelId:null},l={getRules:function(){var t=firebase.auth().currentUser.email.split("@")[0];firebase.database().ref(t+"/groups/").on("value",function(t){o.rules=t.val()})},startSave:function(t){t.preventDefault();var e=$(t.target);o.$panel=e.closest(".panel"),n.modalTitle.text("Save Rule Group"),n.modalBody.html(r.ruleNameForm),n.modalFooter.html(r.saveFooter),n.modalFooter.find(".btn-primary").on("click",l.saveRuleGroup),n.modalBody.find("#save-rule-name").on("keyup",l.processKey),n.modal.modal("show"),n.modal.on("shown.bs.modal",function(){n.modalBody.find("input").focus()})},checkSave:function(){var t=$("#save-rule-name"),e=n.modalFooter.find(".btn-primary"),a=n.modalBody.find(".name-conflict-warning"),l=!1;if(o.saveNameVal=t.val().trim(),!o.saveNameVal||!/^[0-9a-zA-Z\ \-]+$/.test(o.saveNameVal))return t.parent().addClass("has-error"),void(o.canSave=!1);t.parent().removeClass("has-error");for(var r in o.rules)if(o.saveNameVal==r){l=!0;break}l?(e.addClass("btn-warning"),a.removeClass("hidden")):(e.removeClass("btn-warning"),a.addClass("hidden")),o.canSave=!0},saveRuleGroup:function(){if(l.checkSave(),o.canSave){var t=firebase.auth().currentUser.email.split("@")[0],e={};o.$panel.find(".rule-row").each(function(t,a){var n=$(this),o=n.find(".attribute-select").val(),l=n.find(".comparison-type-select").val(),a=n.find(".value-select").val();e[t]={attribute:o,comparisonType:l,value:a}});var a=o.$panel.find(".rule-operator").val();firebase.database().ref(t+"/groups/"+o.saveNameVal).set({rules:e,operator:a,favorite:!1}),n.modalBody.html("The rule group has been saved as <strong>"+o.saveNameVal+"</strong>."),n.modalFooter.find(".btn-primary").remove(),n.modalFooter.find(".btn-default").text("Close").focus(),o.saveNameVal=""}},manageRules:function(t){t.preventDefault();var e=$(t.target),s=e.closest(".panel").attr("id"),i=s?s.split("-")[1]:e.data("panel-id");o.panelId=i;var d={};for(var c in o.rules)o.rules[c].favorite&&(d[c]=o.rules[c],delete o.rules[c]);o.rules=Object.assign(d,o.rules);var u=a(7);n.modalTitle.text("Manage Rule Groups"),n.modalBody.html(r.loadTable(o.rules)),n.modalBody.append(u.tmpls.dataPager(o.rules)),n.modalFooter.html(r.loadFooter),$(".pagination li:nth-of-type(1)").addClass("active"),n.modalBody.find(".table-responsive:nth-of-type(1)").removeClass("hidden"),n.modalBody.find(".pagination a").on("click",u.funcs.updateDataPage),n.modalBody.find(".toggle-favorite").on("click",l.updateFavorite),n.modalBody.find(".load-rule-group").on("click",l.loadRuleGroup),n.modalBody.find(".delete-rule-group").on("click",l.confirmRuleDelete),n.modal.modal("show")},loadRuleGroup:function(t){t.preventDefault();var e=$(t.target),l=$("#panel-"+e.data("panel-id")),r=e.data("group-name"),s=a(8);l.find(".rule-row").remove(),l.find(".rule-operator").val(o.rules[r].operator);for(var i in o.rules[r].rules)s.addRule(t),l.find(".attribute-select").last().val(o.rules[r].rules[i].attribute),l.find(".comparison-type-select").last().val(o.rules[r].rules[i].comparisonType),l.find(".value-select").last().val(o.rules[r].rules[i].value);n.modalBody.html("<strong>"+r+"</strong> has been loaded!")},confirmRuleDelete:function(t){o.ruleName=$(t.target).data("group-name"),n.modalBody.html("Are you sure you want to delete <strong>"+o.ruleName+"</strong>?"),n.modalFooter.html(r.confirmFooter),$(".confirm-delete-rule").on("click",l.deleteRule),$(".back-rules").on("click",l.manageRules)},deleteRule:function(){var t=firebase.auth().currentUser.email.split("@")[0];firebase.database().ref(t+"/groups/"+o.ruleName).remove(),n.modalBody.html("<strong>"+o.ruleName+"</strong> has been deleted!"),n.modalFooter.find(".confirm-delete-rule").remove(),o.ruleName=null},updateFavorite:function(t){var e=$(t.target),a=e.data("group-name"),n=!e.data("favorite"),o=firebase.auth().currentUser.email.split("@")[0];firebase.database().ref(o+"/groups/"+a+"/favorite").set(n),e.hasClass("glyphicon-heart")?(e.addClass("glyphicon-heart-empty"),e.removeClass("glyphicon-heart")):(e.addClass("glyphicon-heart"),e.removeClass("glyphicon-heart-empty")),e.data("favorite",n)},processKey:function(t){$(t.target).parent().removeClass("has-error"),l.checkSave(),13==t.which&&n.modalFooter.find(".btn-primary").trigger("click")}},r={ruleNameForm:function(){return'\n\t\t\t<div class="form-group">\n\t\t\t\t<label for="save-rule-name">Rule Group Name:</label>\n\t\t\t\t<input type="text" id="save-rule-name" class="form-control" placeholder="Females in St. Louis">\n\t\t\t</div>\n\t\t\t<div class="name-conflict-warning hidden">Uh oh! That name already exists! Saving will overwrite an existing rule group!</div>\n\t\t'},saveFooter:function(){return'\n\t\t\t<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>\n\t\t\t<button type="button" class="btn btn-primary">Save Group</button>'},loadTable:function(t){if(!Object.keys(t).length)return"There aren't any saved rule groups.  Save one to get started!";var e="",a=0,n=Object.keys(t).length,l="",r="",s=firebase.auth().currentUser.email.split("@")[0],i=$("#using-as").val(),d="",c=s==i?"<th>Delete</th>":"",u='\n\t\t    \t<div class="table-responsive hidden">\n\t\t\t\t\t<table class="table table-condensed table-striped data-table">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<th>Rule Group Name</th>\n\t\t\t\t\t\t\t<th>Favorite</th>\n\t\t\t\t\t\t\t<th>Load</th>\n\t\t\t\t\t\t\t'+c+"\n\t\t\t\t\t\t</tr>",p="\n\t\t\t\t\t</table>\n\t\t\t\t</div>";e=u;for(var m in t)a++,l=t[m].favorite?"":"-empty",s==i?(d='\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<span class="glyphicon glyphicon-trash delete-rule-group" data-group-name="'+m+'" data-panel-id="'+o.panelId+'"></span>\n\t\t\t\t\t</td>',r=""):(d="",r=" no-hover"),e+="\n\t\t\t\t<tr>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t"+m+'\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<span class="glyphicon glyphicon-heart'+l+" toggle-favorite"+r+'" data-favorite="'+t[m].favorite+'" data-group-name="'+m+'"></span>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<span class="glyphicon glyphicon-open load-rule-group" data-group-name="'+m+'" data-panel-id="'+o.panelId+'">\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</td>\n\t\t\t\t\t'+d+"\n\t\t\t\t</tr>",
a%o.tableSize!=0&&a!=n||(e+=p,a<n&&(e+=u));return e},loadFooter:function(){return'\n\t\t\t<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n\t\t'},confirmFooter:function(){return'\n\t\t\t<button type="button" class="btn btn-default back-rules" data-panel-id="'+o.panelId+'">Back</button>\n\t\t\t<button type="button" class="btn btn-danger confirm-delete-rule">Delete Rule Group</button>'},showWarning:function(){return"\n\t\t\t<h4>Uh Oh!</h4>\n\t\t\t<p>There's already a rule group with a name of <strong>"+o.saveNameVal+"</strong>.  Are you sure you want to overwrite it?</p>\n\t\t"}};t.exports=l},function(t,e){"use strict";var a={modal:$("#modal"),modalTitle:$(".modal-title"),modalBody:$(".modal-body"),modalFooter:$(".modal-footer"),contentType:$("#content-type")},n={blocks:[],attributes:[],defaultSubject:"",defaultPreheader:"",defaultContent:"",topOutput:"",bottomOutput:""},o={validateForm:function(){var t=!0,e=$(".attribute-select, .value-select");a.contentType.val();e.each(function(){null==$(this).val()&&(t=!1,$(this).parent().addClass("has-error"))}),t?(n.blocks=[],o.scrapePage(),o.generateScript(),o.showScript()):(a.modalTitle.html("Get The Code"),a.modalBody.html("Oops! It looks like we're missing some items!"),a.modalFooter.html(l.modalFooter()),a.modal.modal("show"))},scrapePage:function(){var t=$(".content-panel");n.attributes=[],t.each(function(){var t=$(this),e=t.find(".subject-line").val(),a=t.find(".preheader").val(),o=t.find(".content-block").val(),l=t.find(".rule-operator").val(),r=t.find(".rule-row"),s=[];l="and"==l?"AND":"OR",r.each(function(){var t=$(this),e=t.find(".attribute-select").val(),a=t.find(".comparison-type-select").val(),o=t.find(".value-select").val();a="equals"===a?"==":"not-equals"===a?"!=":"greater-than"===a?">=":"<=","NULL"!=o.toUpperCase()?$.isNumeric(o)||(o="'"+o+"'"):(o=o.toUpperCase(),a="is"),s.push({attribute:e,comparisonType:a,value:o}),n.attributes.includes(e)||n.attributes.push(e)}),n.blocks.push({subject:e,preheader:a,content:o,ruleOperator:l,rules:s}),n.defaultSubject=$("#subject-line-default").val(),n.defaultPreheader=$("#preheader-default").val(),n.defaultContent=$("#content-default").val(),n.contentType=$("#content-type").val()})},generateScript:function(){var t=[],e="",a=!0,o="subject"==n.contentType||"subject-preheader"==n.contentType||"subject-preheader-content"==n.contentType,r="preheader"==n.contentType||"subject-preheader"==n.contentType||"subject-preheader-content"==n.contentType,s="content"==n.contentType||"subject-preheader-content"==n.contentType;n.topOutput="",n.bottomOutput="",n.topOutput+="%%[",n.attributes.forEach(function(t){n.topOutput+=l.variable(t)}),n.topOutput+='\n\tvar @Subject\n\t\tset @Subject = ""\n\tvar @Preheader\n\t\tset @Preheader = ""\n]%%',n.blocks.forEach(function(i){t=[],i.rules.forEach(function(e){t.push(l.rule(e))}),e=t.join(" "+i.ruleOperator+" "),a?(a=!1,(o||r)&&(n.topOutput+="\n%%[IF "+e+" THEN]%%"),s&&(n.bottomOutput+="\n%%[IF "+e+" THEN]%%")):((o||r)&&(n.topOutput+="\n%%[ELSEIF "+e+" THEN]%%"),s&&(n.bottomOutput+="\n%%[ELSEIF "+e+" THEN]%%")),o&&(n.topOutput+='\n\t%%[\n\t\tset @Subject = "'+i.subject+'"\n\t]%%'),r&&(n.topOutput+='\n\t%%[\n\t\tset @Preheader = "'+i.preheader+'"\n\t]%%'),s&&(n.bottomOutput+="\n\t"+i.content)}),(o||r)&&(n.topOutput+="\n%%[ELSE]%%\n\t\t\t",o&&(n.topOutput+='\n\t\t%%[\n\t\t\tset @Subject = "'+n.defaultSubject+'"\n\t\t]%%'),r&&(n.topOutput+='\n\t\t%%[\n\t\t\tset @Preheader = "'+n.defaultPreheader+'"\n\t\t]%%'),n.topOutput+="\n%%[ENDIF]%%\n\t\t\t"),s&&(n.bottomOutput+="\n%%[ELSE]%%\n\t"+n.defaultContent+"\n%%[ENDIF]%%")},showScript:function(){a.modalTitle.html("Get The Code"),a.modalBody.html(l.scriptArea()),a.modalFooter.html(l.modalFooter()),a.modal.modal("show"),a.modal.one("shown.bs.modal",function(){a.modalBody.find("#top-code-area, #bottom-code-area").on("click",function(){$(this).select()})})}},l={scriptArea:function(){return'\n\t\t\t<div class="row">\n\t\t\t\t<div class="col-xs-12">\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label for="top-code-area">Ampscript Code: </label>\n\t\t\t\t\t\t<textarea class="form-control" id="top-code-area">'+n.topOutput+'</textarea>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="row">\n\t\t\t\t<div class="col-xs-12">\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label for="bottom-code-area">Content Code: </label>\n\t\t\t\t\t\t<textarea class="form-control" id="bottom-code-area">'+n.bottomOutput+"</textarea>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>"},modalFooter:function(){return'\n\t\t\t<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>'},variable:function(t){return"\n\tvar @"+t+"\n\t\tset @"+t+" = ["+t+"]"},rule:function(t){return t.attribute+" "+t.comparisonType+" "+t.value}};t.exports={funcs:o}},function(t,e,a){"use strict";var n={modal:$("#modal"),modalTitle:$(".modal-title"),modalBody:$(".modal-body"),modalFooter:$(".modal-footer"),contentContainer:$(".content-container")},o={tmpls:null,templateName:"",canSave:!1,tableSize:10},l={getTemplates:function(){var t=$("#using-as").val();firebase.database().ref(t+"/tmpls/").on("value",function(t){o.tmpls=t.val()})},startSave:function(t){t.preventDefault(),n.modalTitle.html("Save Template"),n.modalBody.html(r.templateForm),n.modalFooter.html(r.saveFooter),n.modal.modal("show"),n.modalFooter.find(".btn-primary").on("click",l.saveTemplate),n.modalBody.find("#template-name").on("keyup",l.processKey),n.modal.on("shown.bs.modal",function(){n.modalBody.find("input").focus()})},checkSave:function(){var t=$("#template-name"),e=n.modalFooter.find(".btn-primary"),a=n.modalBody.find(".name-conflict-warning"),l=!1;if(o.templateName=t.val().trim(),!o.templateName||!/^[0-9a-zA-Z\ \-]+$/.test(o.templateName))return t.parent().addClass("has-error"),void(o.canSave=!1);t.parent().removeClass("has-error");for(var r in o.tmpls)if(o.templateName==r){l=!0;break}l?(e.addClass("btn-warning"),a.removeClass("hidden")):(e.removeClass("btn-warning"),a.addClass("hidden")),o.canSave=!0},saveTemplate:function(){if(l.checkSave(),o.canSave){var t={},e={},a={},r=$(".content-panel"),s=firebase.auth().currentUser.email.split("@")[0];r.each(function(n){var o=$(this);e={},a={},o.find(".rule-row").each(function(t,e){var n=$(this),o=n.find(".attribute-select").val(),l=n.find(".comparison-type-select").val(),e=n.find(".value-select").val();a[t]={attribute:o,comparisonType:l,value:e}}),t[n]={operator:o.find(".rule-operator").val(),rules:a}}),t.favorite=!1,firebase.database().ref(s+"/tmpls/"+o.templateName).set(t),n.modalBody.html("The template has been saved as <strong>"+o.templateName+"</strong>."),n.modalFooter.find(".btn-primary").remove(),n.modalFooter.find(".btn-default").text("Close").focus(),o.templateName=""}},manageTemplates:function(t){t.preventDefault();var e={};for(var s in o.tmpls)o.tmpls[s].favorite&&(e[s]=o.tmpls[s],delete o.tmpls[s]);o.tmpls=Object.assign(e,o.tmpls);var i=a(7);n.modalTitle.text("Manage Templates"),n.modalBody.html(r.loadTable(o.tmpls)),n.modalBody.append(i.tmpls.dataPager(o.tmpls)),n.modalFooter.html(r.loadFooter),$(".pagination li:nth-of-type(1)").addClass("active"),n.modalBody.find(".table-responsive:nth-of-type(1)").removeClass("hidden"),n.modalBody.find(".pagination a").on("click",i.funcs.updateDataPage),n.modalBody.find(".toggle-favorite").on("click",l.updateFavorite),n.modalBody.find(".load-template").on("click",l.loadTemplate),n.modalBody.find(".delete-template").on("click",l.confirmTemplateDelete),n.modal.modal("show")},loadTemplate:function(t){n.contentContainer.empty();var e=$(t.target),l=e.data("template-name");o.content=a(8);for(var r in o.tmpls[l])if("favorite"!==r){o.content.addContentBlock();var s=$(".content-panel").last();n.contentContainer.find(".rule-operator").last().val(o.tmpls[l][r].operator);var i=o.tmpls[l][r].rules,d=0;for(var c in i)d&&o.content.addRule(),s.find(".attribute-select").last().val(i[c].attribute),s.find(".comparison-type-select").last().val(i[c].comparisonType),s.find(".value-select").last().val(i[c].value),d++}n.modalBody.html("<strong>"+l+"</strong> has been loaded!"),n.modalFooter.find(".btn-default").focus()},confirmTemplateDelete:function(t){o.templateName=$(t.target).data("template-name"),n.modalBody.html("Are you sure you want to delete <strong>"+o.templateName+"</strong>?"),n.modalFooter.html(r.confirmFooter),$(".confirm-delete-template").on("click",l.deleteTemplate),$(".back-tmpls").on("click",l.manageTemplates)},deleteTemplate:function(){var t=firebase.auth().currentUser.email.split("@")[0];firebase.database().ref(t+"/tmpls/"+o.templateName).remove(),n.modalBody.html("<strong>"+o.templateName+"</strong> has been deleted!"),n.modalFooter.find(".confirm-delete-template").remove(),o.templateName=null},updateFavorite:function(t){var e=$(t.target),a=e.data("template-name"),n=!e.data("favorite"),o=firebase.auth().currentUser.email.split("@")[0],l=$("#using-as").val();o===l&&(firebase.database().ref(o+"/tmpls/"+a+"/favorite").set(n),e.hasClass("glyphicon-heart")?(e.addClass("glyphicon-heart-empty"),e.removeClass("glyphicon-heart")):(e.addClass("glyphicon-heart"),e.removeClass("glyphicon-heart-empty")),e.data("favorite",n))},processKey:function(t){$(t.target).parent().removeClass("has-error"),l.checkSave(),13==t.which&&n.modalFooter.find(".btn-primary").trigger("click")}},r=({contentBlock:a(9),addRuleRow:a(10),confirmDeleteRuleFooter:a(12)},{templateForm:function(){return'\n\t\t\t<div class="form-group">\n\t\t\t\t<label for="template-name">Template Name:</label>\n\t\t\t\t<input type="text" id="template-name" class="form-control" placeholder="My Template">\n\t\t\t</div>\n\t\t\t<div class="name-conflict-warning hidden">Uh oh! That name already exists! Saving will overwrite an existing template!</div>\n\t\t'},saveFooter:function(){return'\n\t\t\t<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>\n\t\t\t<button type="button" class="btn btn-primary">Save Template</button>'},loadFooter:function(){return'\n\t\t\t<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n\t\t'},confirmFooter:function(){return'\n\t\t\t<button type="button" class="btn btn-default back-tmpls">Back</button>\n\t\t\t<button type="button" class="btn btn-danger confirm-delete-template">Delete Template</button>'},showWarning:function(){return"\n\t\t\t<h4>Uh Oh!</h4>\n\t\t\t<p>There's already a template with a name of <strong>"+o.templateName+"</strong>.  Are you sure you want to overwrite it?</p>\n\t\t"},loadTable:function(t){if(!Object.keys(t).length)return"You don't have any tmpls.  Save one to get started!";var e="",a=0,n=Object.keys(t).length,l="",r="",s=firebase.auth().currentUser.email.split("@")[0],i=$("#using-as").val(),d="",c=s==i?"<th>Delete</th>":"",u='\n\t\t    \t<div class="table-responsive hidden">\n\t\t\t\t\t<table class="table table-condensed table-striped data-table">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<th>Template Name</th>\n\t\t\t\t\t\t\t<th>Favorite</th>\n\t\t\t\t\t\t\t<th>Load</th>\n\t\t\t\t\t\t\t'+c+"\n\t\t\t\t\t\t</tr>",p="\n\t\t\t\t\t</table>\n\t\t\t\t</div>";e=u;for(var m in t)a++,l=t[m].favorite?"":"-empty",s==i?(d='\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<span class="glyphicon glyphicon-trash delete-template" data-template-name="'+m+'"></span>\n\t\t\t\t\t</td>',r=""):(d="",r=" no-hover"),e+="\n\t\t\t\t<tr>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t"+m+'\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<span class="glyphicon glyphicon-heart'+l+" toggle-favorite"+r+'" data-favorite="'+t[m].favorite+'" data-template-name="'+m+'"></span>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<span class="glyphicon glyphicon-open load-template" data-template-name="'+m+'">\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</td>\n\t\t\t\t\t'+d+"\n\t\t\t\t</tr>",a%o.tableSize!=0&&a!=n||(e+=p,a<n&&(e+=u));return e}});t.exports={funcs:l}}]);